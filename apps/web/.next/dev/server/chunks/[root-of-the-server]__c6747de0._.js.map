{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jaece/buyani-ecommerce-app/apps/web/src/server/drizzle.ts"],"sourcesContent":["import { drizzle } from \"drizzle-orm/mysql2\";\r\nimport mysql from \"mysql2/promise\";\r\n\r\nconst pool = mysql.createPool({ uri: process.env.DB_URI });\r\nexport const db = drizzle(pool);\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,OAAO,iMAAK,CAAC,UAAU,CAAC;IAAE,KAAK,QAAQ,GAAG,CAAC,MAAM;AAAC;AACjD,MAAM,KAAK,IAAA,8PAAO,EAAC","debugId":null}},
    {"offset": {"line": 134, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jaece/buyani-ecommerce-app/apps/web/src/server/schema/auth-schema.ts"],"sourcesContent":["import {\r\n  mysqlTable,\r\n  varchar,\r\n  text,\r\n  timestamp,\r\n  boolean,\r\n} from \"drizzle-orm/mysql-core\";\r\n\r\nexport const USER_ROLES = {\r\n  ADMIN: \"admin\",\r\n  SELLER: \"seller\",\r\n  CUSTOMER: \"customer\",\r\n};\r\n\r\nexport const user = mysqlTable(\"user\", {\r\n  id: varchar(\"id\", { length: 36 }).primaryKey(),\r\n  name: text(\"name\").notNull(), // username\r\n  first_name: text(\"first_name\"),\r\n  last_name: text(\"last_name\"),\r\n  email: varchar(\"email\", { length: 255 }).notNull().unique(),\r\n  emailVerified: boolean(\"email_verified\").default(false).notNull(),\r\n  image: text(\"image\"),\r\n  role: varchar(\"role\", { length: 50 }).default(USER_ROLES.CUSTOMER).notNull(),\r\n  createdAt: timestamp(\"created_at\", { fsp: 3 }).defaultNow().notNull(),\r\n  updatedAt: timestamp(\"updated_at\", { fsp: 3 })\r\n    .defaultNow()\r\n    .$onUpdate(() => /* @__PURE__ */ new Date())\r\n    .notNull(),\r\n});\r\n\r\nexport const session = mysqlTable(\"session\", {\r\n  id: varchar(\"id\", { length: 36 }).primaryKey(),\r\n  expiresAt: timestamp(\"expires_at\", { fsp: 3 }).notNull(),\r\n  token: varchar(\"token\", { length: 255 }).notNull().unique(),\r\n  createdAt: timestamp(\"created_at\", { fsp: 3 }).defaultNow().notNull(),\r\n  updatedAt: timestamp(\"updated_at\", { fsp: 3 })\r\n    .$onUpdate(() => /* @__PURE__ */ new Date())\r\n    .notNull(),\r\n  ipAddress: text(\"ip_address\"),\r\n  userAgent: text(\"user_agent\"),\r\n  userId: varchar(\"user_id\", { length: 36 })\r\n    .notNull()\r\n    .references(() => user.id, { onDelete: \"cascade\" }),\r\n});\r\n\r\nexport const account = mysqlTable(\"account\", {\r\n  id: varchar(\"id\", { length: 36 }).primaryKey(),\r\n  accountId: text(\"account_id\").notNull(),\r\n  providerId: text(\"provider_id\").notNull(),\r\n  userId: varchar(\"user_id\", { length: 36 })\r\n    .notNull()\r\n    .references(() => user.id, { onDelete: \"cascade\" }),\r\n  accessToken: text(\"access_token\"),\r\n  refreshToken: text(\"refresh_token\"),\r\n  idToken: text(\"id_token\"),\r\n  accessTokenExpiresAt: timestamp(\"access_token_expires_at\", { fsp: 3 }),\r\n  refreshTokenExpiresAt: timestamp(\"refresh_token_expires_at\", { fsp: 3 }),\r\n  scope: text(\"scope\"),\r\n  password: text(\"password\"),\r\n  createdAt: timestamp(\"created_at\", { fsp: 3 }).defaultNow().notNull(),\r\n  updatedAt: timestamp(\"updated_at\", { fsp: 3 })\r\n    .$onUpdate(() => /* @__PURE__ */ new Date())\r\n    .notNull(),\r\n});\r\n\r\nexport const verification = mysqlTable(\"verification\", {\r\n  id: varchar(\"id\", { length: 36 }).primaryKey(),\r\n  identifier: text(\"identifier\").notNull(),\r\n  value: text(\"value\").notNull(),\r\n  expiresAt: timestamp(\"expires_at\", { fsp: 3 }).notNull(),\r\n  createdAt: timestamp(\"created_at\", { fsp: 3 }).defaultNow().notNull(),\r\n  updatedAt: timestamp(\"updated_at\", { fsp: 3 })\r\n    .defaultNow()\r\n    .$onUpdate(() => /* @__PURE__ */ new Date())\r\n    .notNull(),\r\n});\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAQO,MAAM,aAAa;IACxB,OAAO;IACP,QAAQ;IACR,UAAU;AACZ;AAEO,MAAM,OAAO,IAAA,uPAAU,EAAC,QAAQ;IACrC,IAAI,IAAA,iQAAO,EAAC,MAAM;QAAE,QAAQ;IAAG,GAAG,UAAU;IAC5C,MAAM,IAAA,2PAAI,EAAC,QAAQ,OAAO;IAC1B,YAAY,IAAA,2PAAI,EAAC;IACjB,WAAW,IAAA,2PAAI,EAAC;IAChB,OAAO,IAAA,iQAAO,EAAC,SAAS;QAAE,QAAQ;IAAI,GAAG,OAAO,GAAG,MAAM;IACzD,eAAe,IAAA,iQAAO,EAAC,kBAAkB,OAAO,CAAC,OAAO,OAAO;IAC/D,OAAO,IAAA,2PAAI,EAAC;IACZ,MAAM,IAAA,iQAAO,EAAC,QAAQ;QAAE,QAAQ;IAAG,GAAG,OAAO,CAAC,WAAW,QAAQ,EAAE,OAAO;IAC1E,WAAW,IAAA,qQAAS,EAAC,cAAc;QAAE,KAAK;IAAE,GAAG,UAAU,GAAG,OAAO;IACnE,WAAW,IAAA,qQAAS,EAAC,cAAc;QAAE,KAAK;IAAE,GACzC,UAAU,GACV,SAAS,CAAC,IAAM,aAAa,GAAG,IAAI,QACpC,OAAO;AACZ;AAEO,MAAM,UAAU,IAAA,uPAAU,EAAC,WAAW;IAC3C,IAAI,IAAA,iQAAO,EAAC,MAAM;QAAE,QAAQ;IAAG,GAAG,UAAU;IAC5C,WAAW,IAAA,qQAAS,EAAC,cAAc;QAAE,KAAK;IAAE,GAAG,OAAO;IACtD,OAAO,IAAA,iQAAO,EAAC,SAAS;QAAE,QAAQ;IAAI,GAAG,OAAO,GAAG,MAAM;IACzD,WAAW,IAAA,qQAAS,EAAC,cAAc;QAAE,KAAK;IAAE,GAAG,UAAU,GAAG,OAAO;IACnE,WAAW,IAAA,qQAAS,EAAC,cAAc;QAAE,KAAK;IAAE,GACzC,SAAS,CAAC,IAAM,aAAa,GAAG,IAAI,QACpC,OAAO;IACV,WAAW,IAAA,2PAAI,EAAC;IAChB,WAAW,IAAA,2PAAI,EAAC;IAChB,QAAQ,IAAA,iQAAO,EAAC,WAAW;QAAE,QAAQ;IAAG,GACrC,OAAO,GACP,UAAU,CAAC,IAAM,KAAK,EAAE,EAAE;QAAE,UAAU;IAAU;AACrD;AAEO,MAAM,UAAU,IAAA,uPAAU,EAAC,WAAW;IAC3C,IAAI,IAAA,iQAAO,EAAC,MAAM;QAAE,QAAQ;IAAG,GAAG,UAAU;IAC5C,WAAW,IAAA,2PAAI,EAAC,cAAc,OAAO;IACrC,YAAY,IAAA,2PAAI,EAAC,eAAe,OAAO;IACvC,QAAQ,IAAA,iQAAO,EAAC,WAAW;QAAE,QAAQ;IAAG,GACrC,OAAO,GACP,UAAU,CAAC,IAAM,KAAK,EAAE,EAAE;QAAE,UAAU;IAAU;IACnD,aAAa,IAAA,2PAAI,EAAC;IAClB,cAAc,IAAA,2PAAI,EAAC;IACnB,SAAS,IAAA,2PAAI,EAAC;IACd,sBAAsB,IAAA,qQAAS,EAAC,2BAA2B;QAAE,KAAK;IAAE;IACpE,uBAAuB,IAAA,qQAAS,EAAC,4BAA4B;QAAE,KAAK;IAAE;IACtE,OAAO,IAAA,2PAAI,EAAC;IACZ,UAAU,IAAA,2PAAI,EAAC;IACf,WAAW,IAAA,qQAAS,EAAC,cAAc;QAAE,KAAK;IAAE,GAAG,UAAU,GAAG,OAAO;IACnE,WAAW,IAAA,qQAAS,EAAC,cAAc;QAAE,KAAK;IAAE,GACzC,SAAS,CAAC,IAAM,aAAa,GAAG,IAAI,QACpC,OAAO;AACZ;AAEO,MAAM,eAAe,IAAA,uPAAU,EAAC,gBAAgB;IACrD,IAAI,IAAA,iQAAO,EAAC,MAAM;QAAE,QAAQ;IAAG,GAAG,UAAU;IAC5C,YAAY,IAAA,2PAAI,EAAC,cAAc,OAAO;IACtC,OAAO,IAAA,2PAAI,EAAC,SAAS,OAAO;IAC5B,WAAW,IAAA,qQAAS,EAAC,cAAc;QAAE,KAAK;IAAE,GAAG,OAAO;IACtD,WAAW,IAAA,qQAAS,EAAC,cAAc;QAAE,KAAK;IAAE,GAAG,UAAU,GAAG,OAAO;IACnE,WAAW,IAAA,qQAAS,EAAC,cAAc;QAAE,KAAK;IAAE,GACzC,UAAU,GACV,SAAS,CAAC,IAAM,aAAa,GAAG,IAAI,QACpC,OAAO;AACZ","debugId":null}},
    {"offset": {"line": 252, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jaece/buyani-ecommerce-app/apps/web/src/lib/validation.ts"],"sourcesContent":["import z from \"zod\";\r\n\r\nexport const passwordSchema = z\r\n  .string()\r\n  .min(1, { message: \"Password is required\" })\r\n  .min(8, { message: \"Password must be at least 8 characters\" })\r\n  .regex(/[^A-Za-z0-9]/, {\r\n    message: \"Password must contain at least one special character\",\r\n  });\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,iBAAiB,yMAAC,CAC5B,MAAM,GACN,GAAG,CAAC,GAAG;IAAE,SAAS;AAAuB,GACzC,GAAG,CAAC,GAAG;IAAE,SAAS;AAAyC,GAC3D,KAAK,CAAC,gBAAgB;IACrB,SAAS;AACX","debugId":null}},
    {"offset": {"line": 311, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jaece/buyani-ecommerce-app/apps/web/src/lib/env.ts"],"sourcesContent":["import { z } from \"zod\";\r\n\r\nconst envSchema = z.object({\r\n  DB_URI: z.string().nonempty(\"DB_URI is required\"),\r\n  BETTER_AUTH_URL: z.string().nonempty(\"BETTER_AUTH_URL is required\"),\r\n  BETTER_AUTH_SECRET: z.string().nonempty(\"BETTER_AUTH_SECRET is required\"),\r\n  GMAIL_USER: z.string().email(\"GMAIL_USER must be a valid email\"),\r\n  GMAIL_APP_KEY: z.string().nonempty(\"GMAIL_APP_KEY is required\"),\r\n  GOOGLE_CLIENT_ID: z.string().nonempty(\"GOOGLE_CLIENT_ID is required\"),\r\n  GOOGLE_CLIENT_SECRET: z.string().nonempty(\"GOOGLE_CLIENT_SECRET is required\"),\r\n});\r\n\r\nconst parsed = envSchema.safeParse(process.env);\r\n\r\nif (!parsed.success) {\r\n  console.error(\"Missing or invalid environment variables:\");\r\n  console.error(parsed.error.format());\r\n  process.exit(1);\r\n}\r\n\r\nexport const env = parsed.data;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,YAAY,oOAAC,CAAC,MAAM,CAAC;IACzB,QAAQ,oOAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IAC5B,iBAAiB,oOAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IACrC,oBAAoB,oOAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IACxC,YAAY,oOAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IAC7B,eAAe,oOAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IACnC,kBAAkB,oOAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IACtC,sBAAsB,oOAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;AAC5C;AAEA,MAAM,SAAS,UAAU,SAAS,CAAC,QAAQ,GAAG;AAE9C,IAAI,CAAC,OAAO,OAAO,EAAE;IACnB,QAAQ,KAAK,CAAC;IACd,QAAQ,KAAK,CAAC,OAAO,KAAK,CAAC,MAAM;IACjC,QAAQ,IAAI,CAAC;AACf;AAEO,MAAM,MAAM,OAAO,IAAI","debugId":null}},
    {"offset": {"line": 337, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jaece/buyani-ecommerce-app/apps/web/src/server/mailer.ts"],"sourcesContent":["import nodemailer from \"nodemailer\";\r\nimport { env } from \"@/lib/env\";\r\n\r\ninterface sendMailProps {\r\n  to: string;\r\n  subject: string;\r\n  text: string;\r\n}\r\n\r\nexport async function sendMail({ to, subject, text }: sendMailProps) {\r\n  const transporter = nodemailer.createTransport({\r\n    service: \"gmail\",\r\n    auth: {\r\n      user: env.GMAIL_USER,\r\n      pass: env.GMAIL_APP_KEY,\r\n    },\r\n  });\r\n\r\n  await transporter.sendMail({\r\n    from: env.GMAIL_USER,\r\n    to,\r\n    subject,\r\n    text,\r\n  });\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAQO,eAAe,SAAS,EAAE,EAAE,EAAE,OAAO,EAAE,IAAI,EAAiB;IACjE,MAAM,cAAc,mNAAU,CAAC,eAAe,CAAC;QAC7C,SAAS;QACT,MAAM;YACJ,MAAM,yIAAG,CAAC,UAAU;YACpB,MAAM,yIAAG,CAAC,aAAa;QACzB;IACF;IAEA,MAAM,YAAY,QAAQ,CAAC;QACzB,MAAM,yIAAG,CAAC,UAAU;QACpB;QACA;QACA;IACF;AACF","debugId":null}},
    {"offset": {"line": 364, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jaece/buyani-ecommerce-app/apps/web/src/server/auth.ts"],"sourcesContent":["import { drizzleAdapter } from \"better-auth/adapters/drizzle\";\r\nimport { betterAuth } from \"better-auth\";\r\nimport { createAuthMiddleware, APIError } from \"better-auth/api\";\r\nimport { db } from \"./drizzle\";\r\nimport { account, user, session, verification } from \"./schema/auth-schema\";\r\nimport { passwordSchema } from \"@/lib/validation\";\r\nimport { sendMail } from \"./mailer\";\r\nimport { env } from \"@/lib/env\";\r\n\r\nexport const auth = betterAuth({\r\n  database: drizzleAdapter(db, {\r\n    provider: \"mysql\",\r\n    schema: { user, account, session, verification },\r\n  }),\r\n\r\n  emailAndPassword: {\r\n    enabled: true,\r\n    async sendResetPassword({ user, url }) {\r\n      await sendMail({\r\n        to: user.email,\r\n        subject: \"Reset your password\",\r\n        text: \"Click the link to reset your password: \" + url,\r\n      });\r\n    },\r\n  },\r\n\r\n  emailVerification: {\r\n    sendOnSignUp: true,\r\n    autoSignInAfterVerification: true,\r\n    async sendVerificationEmail({ user, url }) {\r\n      await sendMail({\r\n        to: user.email,\r\n        subject: \"Verify your email\",\r\n        text: \"Click the link to verify your email: \" + url,\r\n      });\r\n    },\r\n  },\r\n\r\n  user: {\r\n    changeEmail: {\r\n      enabled: true,\r\n      async sendChangeEmailVerification({ user, newEmail, url }) {\r\n        await sendMail({\r\n          to: user.email,\r\n          subject: \"Approve email change\",\r\n          text: `Your email has been changed to ${newEmail}. Click the link to approve the change: ${url}`,\r\n        });\r\n      },\r\n    },\r\n    additionalFields: {\r\n      role: {\r\n        type: \"string\",\r\n        input: false,\r\n      },\r\n      first_name: {\r\n        type: \"string\",\r\n        required: false,\r\n        input: true,\r\n      },\r\n      last_name: {\r\n        type: \"string\",\r\n        required: false,\r\n        input: true,\r\n      },\r\n    },\r\n  },\r\n\r\n  hooks: {\r\n    before: createAuthMiddleware(async (ctx) => {\r\n      // validate password in server sside\r\n\r\n      if (\r\n        ctx.path === \"/sign-up/email\" ||\r\n        ctx.path === \"/reset-password\" ||\r\n        ctx.path === \"/change-password\"\r\n      ) {\r\n        const password = ctx.body.password || ctx.body.newPassword;\r\n        const { error } = passwordSchema.safeParse(password);\r\n\r\n        if (error) {\r\n          throw new APIError(\"BAD_REQUEST\", {\r\n            message: \"Password not strong enough\",\r\n          });\r\n        }\r\n      }\r\n    }),\r\n  },\r\n\r\n  socialProviders: {\r\n    google: {\r\n      clientId: env.GOOGLE_CLIENT_ID,\r\n      clientSecret: env.GOOGLE_CLIENT_SECRET,\r\n    },\r\n  },\r\n});\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AAEO,MAAM,OAAO,IAAA,6RAAU,EAAC;IAC7B,UAAU,IAAA,iRAAc,EAAC,+IAAE,EAAE;QAC3B,UAAU;QACV,QAAQ;YAAE,MAAA,kKAAI;YAAE,SAAA,qKAAO;YAAE,SAAA,qKAAO;YAAE,cAAA,0KAAY;QAAC;IACjD;IAEA,kBAAkB;QAChB,SAAS;QACT,MAAM,mBAAkB,EAAE,IAAI,EAAE,GAAG,EAAE;YACnC,MAAM,IAAA,oJAAQ,EAAC;gBACb,IAAI,KAAK,KAAK;gBACd,SAAS;gBACT,MAAM,4CAA4C;YACpD;QACF;IACF;IAEA,mBAAmB;QACjB,cAAc;QACd,6BAA6B;QAC7B,MAAM,uBAAsB,EAAE,IAAI,EAAE,GAAG,EAAE;YACvC,MAAM,IAAA,oJAAQ,EAAC;gBACb,IAAI,KAAK,KAAK;gBACd,SAAS;gBACT,MAAM,0CAA0C;YAClD;QACF;IACF;IAEA,MAAM;QACJ,aAAa;YACX,SAAS;YACT,MAAM,6BAA4B,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,EAAE;gBACvD,MAAM,IAAA,oJAAQ,EAAC;oBACb,IAAI,KAAK,KAAK;oBACd,SAAS;oBACT,MAAM,CAAC,+BAA+B,EAAE,SAAS,wCAAwC,EAAE,KAAK;gBAClG;YACF;QACF;QACA,kBAAkB;YAChB,MAAM;gBACJ,MAAM;gBACN,OAAO;YACT;YACA,YAAY;gBACV,MAAM;gBACN,UAAU;gBACV,OAAO;YACT;YACA,WAAW;gBACT,MAAM;gBACN,UAAU;gBACV,OAAO;YACT;QACF;IACF;IAEA,OAAO;QACL,QAAQ,IAAA,2RAAoB,EAAC,OAAO;YAClC,oCAAoC;YAEpC,IACE,IAAI,IAAI,KAAK,oBACb,IAAI,IAAI,KAAK,qBACb,IAAI,IAAI,KAAK,oBACb;gBACA,MAAM,WAAW,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,IAAI,CAAC,WAAW;gBAC1D,MAAM,EAAE,KAAK,EAAE,GAAG,2JAAc,CAAC,SAAS,CAAC;gBAE3C,IAAI,OAAO;oBACT,MAAM,IAAI,wNAAQ,CAAC,eAAe;wBAChC,SAAS;oBACX;gBACF;YACF;QACF;IACF;IAEA,iBAAiB;QACf,QAAQ;YACN,UAAU,yIAAG,CAAC,gBAAgB;YAC9B,cAAc,yIAAG,CAAC,oBAAoB;QACxC;IACF;AACF","debugId":null}},
    {"offset": {"line": 471, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jaece/buyani-ecommerce-app/apps/web/src/app/api/auth/%5B...all%5D/route.ts"],"sourcesContent":["import { auth } from \"@/server/auth\";\r\nimport { toNextJsHandler } from \"better-auth/next-js\";\r\n\r\nexport const { POST, GET } = toNextJsHandler(auth);\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,MAAM,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,IAAA,qPAAe,EAAC,8IAAI","debugId":null}}]
}